---
const { selectedItem } = Astro.props;
import Icon from "./Icon.astro";

const socials: Array<{ name: string; href: string; label: string }> = [
  { name: "twitter", href: "https://twitter.com/erlandzz", label: "Twitter" },
  { name: "instagram", href: "https://www.instagram.com/erlandramdhani", label: "Instagram" },
  { name: "facebook", href: "https://www.facebook.com/erlandramdhani", label: "Facebook" },
  { name: "github", href: "https://github.com/erlandv", label: "GitHub" },
  { name: "bluesky", href: "https://bsky.app/profile/erland.me", label: "Bluesky" },
];
---

<aside
  data-animation="default"
  data-collapse="medium"
  data-duration="400"
  data-easing="ease"
  data-easing2="ease"
  role="banner"
  class="sidebar w-nav"
>
  <div class="nav-content">
    <a href="/" class="w-nav-brand" aria-label="home">
      <div class="niv-data">
        <img
          src="/assets/erland.webp"
          loading="eager"
          alt="Profile picture"
          class="niv-image"
        />
        <div>
          <div class="label-white">Erland Ramdhani</div>
          <div class="label-gray">Web Developer</div>
        </div>
      </div>
    </a>

    <nav role="navigation" class="w-nav-menu">
      <a
        href="/"
        class={`nav-link-container w-inline-block ${
          selectedItem === "home" ? "w--current" : ""
        }`}
      >
        <Icon name="home" class="nav-link-image" />
        <div>Home</div>
      </a>
      <a
        href="/portfolio/web-development/"
        class={`nav-link-container w-inline-block ${
          selectedItem === "web-development" ? "w--current" : ""
        }`}
        aria-current={selectedItem === "web-development"
          ? "page"
          : undefined}
      >
        <Icon name="code" class="nav-link-image" />
        <div>Web development</div>
      </a>
      <a
        href="/portfolio/cloud-infra/"
        class={`nav-link-container w-inline-block ${
          selectedItem === "cloud-infra" ? "w--current" : ""
        }`}
      >
        <Icon name="dns" class="nav-link-image" />
        <div>Cloud Infra</div>
      </a>
      <a
        href="/portfolio/personal-projects/"
        class={`nav-link-container w-inline-block ${
          selectedItem === "personal-projects" ? "w--current" : ""
        }`}
      >
        <Icon name="favorite" class="nav-link-image" />
        <div>Personal projects</div>
      </a>
      <a
        href="/download/"
        class={`nav-link-container w-inline-block ${
          selectedItem === "download" ? "w--current" : ""
        }`}
        aria-current={selectedItem === "download" ? "page" : undefined}
      >
        <Icon name="download" class="nav-link-image" />
        <div>Download</div>
      </a>
      <a
        href="/blog/"
        class={`nav-link-container w-inline-block ${
          selectedItem === "blog" ? "w--current" : ""
        }`}
      >
        <Icon name="blog" class="nav-link-image" />
        <div>Blog</div>
      </a>
      <div class="socials socials--menu">
        {socials.map((s) => (
          <a href={s.href} aria-label={s.label} class="social-link" target="_blank" rel="noopener noreferrer">
            <Icon name={s.name} class="social-icon" ariaLabel={s.label} />
          </a>
        ))}
      </div>
    </nav>

    <div class="socials socials--sidebar">
      {socials.map((s) => (
        <a href={s.href} aria-label={s.label} class="social-link" target="_blank" rel="noopener noreferrer">
          <Icon name={s.name} class="social-icon" ariaLabel={s.label} />
        </a>
      ))}
    </div>

    <div
      class="navbar-icon-button w-nav-button"
      style="-webkit-user-select: text;"
      aria-label="menu"
      role="button"
      tabindex="0"
    >
      <Icon name="menu" class="navbar-icon" />
    </div>
  </div>

  <script>
    import { setupNav } from "../scripts/nav.js";

    let cleanup: (() => void) | undefined;
    document.addEventListener("astro:page-load", () => {
      if (cleanup) cleanup();
      cleanup = setupNav();
    });

    document.addEventListener("astro:before-swap", () => {
      if (cleanup) cleanup();
    });
  </script>
</aside>
