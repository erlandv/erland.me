---
/**
 * StarRating Component
 *
 * Displays a star rating with numerical value and review count.
 * Shows full stars and half stars based on rating value.
 * Includes proper ARIA labels for accessibility.
 *
 * @component
 * @example
 * <StarRating
 *   ratingValue={4.5}
 *   reviewCount={127}
 *   bestRating={5}
 *   class="custom-rating"
 * />
 *
 * @param {Object} props
 * @param {number} props.ratingValue - Rating value (e.g., 4.5)
 * @param {number} props.reviewCount - Number of reviews
 * @param {number} [props.bestRating=5] - Maximum possible rating (default: 5)
 * @param {string} [props.class] - Additional CSS class for styling
 */
import styles from './star-rating.module.css';

interface Props {
  ratingValue: number;
  reviewCount: number;
  bestRating?: number;
  class?: string;
}

const {
  ratingValue,
  reviewCount,
  bestRating = 5,
  class: className,
} = Astro.props;

// Calculate full stars and half star
const fullStars = Math.floor(ratingValue);
const hasHalfStar = ratingValue % 1 >= 0.5;

// Import SVG content directly
import fullStarSvg from '@/icons/rating-star.svg?raw';
import halfStarSvg from '@/icons/rating-half-star.svg?raw';
---

<div
  class:list={[styles.rating, className]}
  aria-label={`Rating: ${ratingValue} out of ${bestRating} stars, based on ${reviewCount} reviews`}
>
  <div class={styles.stars} aria-hidden='true'>
    {
      Array.from({ length: fullStars }).map(() => (
        <span class={styles.star} set:html={fullStarSvg} />
      ))
    }
    {hasHalfStar && <span class={styles.star} set:html={halfStarSvg} />}
  </div>
  <div class={styles.text}>
    <span class={styles.value}>{ratingValue.toFixed(1)}</span>
    <span class={styles.separator}>Â·</span>
    <span class={styles.count}
      >{reviewCount} {reviewCount === 1 ? 'review' : 'reviews'}</span
    >
  </div>
</div>
