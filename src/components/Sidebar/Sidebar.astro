---
/**
 * Sidebar Component
 * 
 * Main navigation sidebar with profile header, navigation links, theme toggle, and social links.
 * Supports collapsible state (desktop) and mobile menu drawer.
 * 
 * Features:
 * - Profile avatar with stories button
 * - Navigation links with active state highlighting
 * - Mobile hamburger menu toggle
 * - Theme toggle integration
 * - Social media links (both sidebar and mobile menu variants)
 * - Responsive design (drawer on mobile, collapsible on desktop)
 * - View transitions persistence (data-astro-transition-persist)
 * 
 * Navigation state managed by:
 * - SidebarController.astro (state management)
 * - CSS classes and data attributes
 * - Checkbox inputs for toggle state
 * 
 * @component
 * @example
 * <Sidebar selectedItem="blog" />
 * 
 * @param {Object} props
 * @param {string} [props.selectedItem] - Currently active navigation item ("home" | "web-development" | "cloud-infra" | "personal-projects" | "download" | "blog")
 */
import Icon from '@components/Icon.astro';
import ThemeToggle from '@components/ThemeToggle/ThemeToggle.astro';
import './sidebar-global.css';
import './sidebar-local.module.css';
import socialsStyles from './sidebar-socials.module.css';
import navStyles from './sidebar-nav.module.css';
import { sidebarSocialLinks as socials } from './social-links';

const { selectedItem } = Astro.props;
---

<!-- Sidebar Container - Persists across view transitions via data-astro-transition-persist -->
<aside
  data-animation='default'
  data-collapse='medium'
  data-duration='400'
  data-easing='ease'
  data-easing2='ease'
  data-astro-transition-persist='sidebar'
  class='sidebar w-nav'
>
  <div class='nav-content'>
    <!-- Profile Header Section - Desktop sidebar branding -->
    <div class='w-nav-brand'>
      <div class='profile-header'>
        <div class='niv-data'>
          <!-- Avatar Button - Opens stories modal when clicked -->
          <button
            type='button'
            class='sidebar__avatar-button'
            data-stories
            aria-label='View stories'
            title="View stories"
          >
            <img
              src='/assets/profile/avatar.webp'
              loading='eager'
              alt='Profile picture'
              class='niv-image'
            />
          </button>
          <!-- Profile Info Text -->
          <div class='profile-text'>
            <div class='label-white'>Erland Ramdhani</div>
            <div class='label-gray'>Web Developer</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Mobile Header Controls - Theme toggle and hamburger menu (visible on mobile only) -->
    <div class='mobile-header-controls'>
      <!-- Theme Toggle - Dark/Light mode switcher -->
      <div class='theme-toggle-container theme-toggle-container--sidebar'>
        <ThemeToggle />
      </div>
      <!-- Hamburger Menu Button - Toggles mobile navigation drawer -->
      <label
        for='nav-toggle'
        class='navbar-icon-button w-nav-button'
        style='-webkit-user-select: text;'
        aria-label='Toggle menu'
        aria-controls='site-nav'
        aria-expanded='false'
        tabindex='0'
      >
        <span class='icon-switch icon-switch--menu'
          ><Icon name='navMobile' class='navbar-icon' /></span
        >
        <span class='icon-switch icon-switch--close'
          ><Icon name='btnClose' class='navbar-icon' /></span
        >
      </label>
    </div>

    <!-- Hidden Checkbox Inputs - Control navigation and sidebar toggle states via CSS -->
    <!-- Mobile menu toggle (controls drawer visibility on mobile) -->
    <input
      type='checkbox'
      id='nav-toggle'
      class='nav-toggle'
      aria-label='Toggle navigation'
    />

    <!-- Desktop sidebar collapse toggle -->
    <input
      type='checkbox'
      id='sidebar-toggle'
      class='sidebar-toggle'
      aria-label='Toggle sidebar'
    />

    <!-- Main Navigation Menu - Contains all navigation links -->
    <nav id='site-nav' role='navigation' class='w-nav-menu'>
      <!-- Navigation Link: Home -->
      <a
        href='/'
        aria-label='Home'
        data-label='Home'
        title='Home'
        class:list={[
          navStyles['nav-link-container'],
          'nav-link-container',
          'w-inline-block',
          selectedItem === 'home' && 'w--current',
        ]}
      >
        <Icon
          name='navHome'
          class:list={[navStyles['nav-link-image'], 'nav-link-image']}
        />
        <div class='nav-text'>Home</div>
      </a>
      
      <!-- Navigation Link: Web Development Portfolio -->
      <a
        href='/portfolio/web-development/'
        aria-label='Web Development'
        data-label='Web Development'
        title='Web Development'
        class:list={[
          navStyles['nav-link-container'],
          'nav-link-container',
          'w-inline-block',
          selectedItem === 'web-development' && 'w--current',
        ]}
        aria-current={selectedItem === 'web-development' ? 'page' : undefined}
      >
        <Icon
          name='navWeb'
          class:list={[navStyles['nav-link-image'], 'nav-link-image']}
        />
        <div class='nav-text'>Web development</div>
      </a>
      
      <!-- Navigation Link: Cloud Infrastructure Portfolio -->
      <a
        href='/portfolio/cloud-infra/'
        aria-label='Cloud Infrastructure'
        data-label='Cloud Infra'
        title='Cloud Infra'
        class:list={[
          navStyles['nav-link-container'],
          'nav-link-container',
          'w-inline-block',
          selectedItem === 'cloud-infra' && 'w--current',
        ]}
      >
        <Icon
          name='navInfra'
          class:list={[navStyles['nav-link-image'], 'nav-link-image']}
        />
        <div class='nav-text'>Cloud Infra</div>
      </a>
      
      <!-- Navigation Link: Personal Projects Portfolio -->
      <a
        href='/portfolio/personal-projects/'
        aria-label='Personal Projects'
        data-label='Personal Projects'
        title='Personal Projects'
        class:list={[
          navStyles['nav-link-container'],
          'nav-link-container',
          'w-inline-block',
          selectedItem === 'personal-projects' && 'w--current',
        ]}
      >
        <Icon
          name='navPersonal'
          class:list={[navStyles['nav-link-image'], 'nav-link-image']}
        />
        <div class='nav-text'>Personal projects</div>
      </a>
      
      <!-- Navigation Link: Download Page -->
      <a
        href='/download/'
        aria-label='Download'
        data-label='Download'
        title='Download'
        class:list={[
          navStyles['nav-link-container'],
          'nav-link-container',
          'w-inline-block',
          selectedItem === 'download' && 'w--current',
        ]}
        aria-current={selectedItem === 'download' ? 'page' : undefined}
      >
        <Icon
          name='navDownload'
          class:list={[navStyles['nav-link-image'], 'nav-link-image']}
        />
        <div class='nav-text'>Download</div>
      </a>
      
      <!-- Navigation Link: Blog Posts -->
      <a
        href='/blog/'
        aria-label='Blog Posts'
        data-label='Blog Posts'
        title='Blog Posts'
        class:list={[
          navStyles['nav-link-container'],
          'nav-link-container',
          'w-inline-block',
          selectedItem === 'blog' && 'w--current',
        ]}
      >
        <Icon
          name='navBlog'
          class:list={[navStyles['nav-link-image'], 'nav-link-image']}
        />
        <div class='nav-text'>Blog Posts</div>
      </a>

      <!-- Social Links - Mobile Menu Variant (visible inside mobile drawer) -->
      <div class:list={[socialsStyles.socials, 'socials--menu']}>
        {
          socials.map(s => (
            <a
              href={s.href}
              aria-label={s.label}
              class={socialsStyles['social-link']}
              target='_blank'
              rel='noopener noreferrer'
            >
              <Icon
                name={s.name}
                class={socialsStyles['social-icon']}
                ariaLabel={s.label}
              />
            </a>
          ))
        }
      </div>
    </nav>

    <!-- Social Links - Desktop Sidebar Variant (visible at bottom of sidebar on desktop) -->
    <div class:list={[socialsStyles.socials, 'socials--sidebar']}>
      {
        socials.map(s => (
          <a
            href={s.href}
            aria-label={s.label}
            class={socialsStyles['social-link']}
            target='_blank'
            rel='noopener noreferrer'
          >
            <Icon
              name={s.name}
              class={socialsStyles['social-icon']}
              ariaLabel={s.label}
            />
          </a>
        ))
      }
    </div>
  </div>
</aside>
